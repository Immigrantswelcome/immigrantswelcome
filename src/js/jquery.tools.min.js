"use strict";!function(a){function b(a){return function(){return a}}function c(c,f){function g(){this.bindThis(),this.fire=c.add(this),m&&("string"==typeof m&&(m={color:m}),m.closeOnClick=m.closeOnEsc=!1);var b=f.target||c.attr("rel");if(i=b?a(b):c,!i.length)throw"Could not find Overlay: "+b;c&&c.index(i)===-1&&c.click(function(a){return this.load(a),a.preventDefault()}.bind(this)),Object.keys(k).forEach(function(b){var c=k[b];a.isFunction(f[c])&&a(this).on(c,f[c]),this[c]=function(b){return b&&a(this).on(c,b),this}},this),h=i.find(f.close||".close"),h.length||f.close||(h=a('<a class="close"></a>'),i.prepend(h)),h.click(function(a){this.close(a)}.bind(this)),f.load&&this.load()}var h,i,j,k={ONBEFORELOAD:"onBeforeLoad",ONSTART:"onStart",ONLOAD:"onLoad",ONBEFORECLOSE:"onBeforeClose",ONCLOSE:"onClose"},l=a(window),m=a.tools.expose&&(f.mask||f.expose),n=Math.random().toString().slice(10),o={top:null,left:null};return a.extend(g.prototype,{bindThis:function(){this.close=this.close.bind(this)},load:function(b){if(this.isOpened())return this;var c=e[f.effect];if(!c)throw"Overlay: cannot find effect : "+f.effect;return f.oneInstance&&a.each(d,function(){this.close(b)}),b=b||a.Event(),b.type=k.ONBEFORELOAD,this.fire.trigger(b),b.isDefaultPrevented()?this:(j=!0,m&&a(i).expose(m),this.position(),c[0].call(this,n,o,function(){j&&(b.type=k.ONSTART,this.fire.trigger(b))}.bind(this),function(){j&&(b.type=k.ONLOAD,this.fire.trigger(b))}.bind(this)),m&&f.closeOnClick&&a.mask.getMask().one("click",this.close),f.closeOnClick&&a(document).on("click."+n,function(b){a(b.target).parents(i).length||this.close(b)}.bind(this)),f.closeOnEsc&&a(document).on("keydown."+n,function(a){27===a.keyCode&&this.close(a)}.bind(this)),this)},close:function(b){return this.isOpened()?(b=b||a.Event(),b.type=k.ONBEFORECLOSE,this.fire.trigger(b),b.isDefaultPrevented()?void 0:(j=!1,e[f.effect][1].call(this,n,function(){b.type=k.ONCLOSE,this.fire.trigger(b)}.bind(this)),a(document).off("click."+n+" keydown."+n),m&&a.mask.close(),this)):this},getOverlay:function(){return i},getTrigger:function(){return c},getClosers:function(){return h},isOpened:function(){return j},getConf:function(){return f},position:function(){var a=f.top,c=f.left;return a="string"==typeof a?"center"===a?function(){return Math.max((l.height()-i.outerHeight(!0))/2,0)}:function(a){return function(){var b=i.outerHeight(!0),c=l.height(),d=parseInt(a,10)/100*c;return b+d<c?d:Math.max((c-b)/2,0)}}(a):b(a),c="center"===c?function(){return Math.max((l.width()-i.outerWidth(!0))/2,0)}:b(c),o.top=a,o.left=c,this},resize:function(){return l.trigger("resize."+n),this}}),new g}var d=[],e={};a.tools=a.tools||{version:"1.0.0"},a.tools.overlay={addEffect:function(a,b,c){e[a]=[b,c]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!0,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}},a.tools.overlay.addEffect("default",function(b,c,d,e){function f(){j.top=0,j.left=0,j.maxHeight="none",h.css(j);var a=j.top=c.top();j.left=c.left(),g.fixed?(j.maxHeight=i.height()-a,j.overflow="scroll"):(j.top+=i.scrollTop(),j.left+=i.scrollLeft()),h.css(j)}var g=this.getConf(),h=this.getOverlay(),i=a(window),j={};j.position=g.fixed?"fixed":"absolute",j.opacity=0,f(),h.show(),d(),h.fadeTo(g.speed,1,e),j.opacity=1,i.on("resize."+b,f)},function(b,c){a(window).off("resize."+b),this.getOverlay().fadeOut(this.getConf().closeSpeed,c)}),a.fn.overlay=function(b){var e=this.data("overlay");return e?e:(a.isFunction(b)&&(b={onBeforeLoad:b}),b=a.extend(!0,{},a.tools.overlay.conf,b),this.each(function(){e=c(a(this),b),d.push(e),a(this).data("overlay",e)}),b.api?e:this)}}(jQuery),function(a){function b(){return{width:a(window).width(),height:a(document).height()}}function c(b){if(b)return b.call(a.mask)}a.tools=a.tools||{version:"1.0.0"};var d;d=a.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var e,f,g,h,i;a.mask={load:function(j,k){if(g)return this;"string"==typeof j&&(j={color:j}),j=j||h,h=j=a.extend(a.extend({},d.conf),j),e=a("#"+j.maskId),e.length||(e=a("<div/>").attr("id",j.maskId),a("body").append(e));var l=b();return e.css({position:"absolute",top:0,left:0,width:l.width,height:l.height,display:"none",opacity:j.startOpacity,zIndex:j.zIndex}),j.color&&e.css("backgroundColor",j.color),c(j.onBeforeLoad)===!1?this:(j.closeOnEsc&&a(document).on("keydown.mask",function(b){27===b.keyCode&&a.mask.close(b)}),j.closeOnClick&&e.on("click.mask",function(b){a.mask.close(b)}),a(window).on("resize.mask",function(){a.mask.fit()}),k&&k.length&&(i=k.eq(0).css("zIndex"),a.each(k,function(){var b=a(this);/relative|absolute|fixed/i.test(b.css("position"))||b.css("position","relative")}),f=k.css({zIndex:Math.max(j.zIndex+1,"auto"===i?0:i)})),e.css({display:"block"}).fadeTo(j.loadSpeed,j.opacity,function(){a.mask.fit(),c(j.onLoad),g="full"}),g=!0,this)},close:function(){if(g){if(c(h.onBeforeClose)===!1)return this;e.fadeOut(h.closeSpeed,function(){c(h.onClose),f&&f.css({zIndex:i}),g=!1}),a(document).off("keydown.mask"),e.off("click.mask"),a(window).off("resize.mask")}return this},fit:function(){if(g){var a=b();e.css({width:a.width,height:a.height})}},getMask:function(){return e},isLoaded:function(a){return a?"full"===g:g},getConf:function(){return h},getExposed:function(){return f}},a.fn.mask=function(b){return a.mask.load(b),this},a.fn.expose=function(b){return a.mask.load(b,this),this}}(jQuery);